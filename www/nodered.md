# Node-Red
<p align="center">
  <img src="https://upload.wikimedia.org/wikipedia/commons/2/2b/Node-red-icon.png">
</p>


<p align="center">

[Changelog](https://github.com/sineczek/HomeAssistant/blob/master/www/changelog.md)  [Guts](https://github.com/sineczek/HomeAssistant/blob/master/www/guts.md)  [Node-Red](https://github.com/sineczek/HomeAssistant/blob/master/www/nodered.md)

</p>

## My flows

### Lights

#### PIR cellar stairs leds
<p align="center">
  <img width="800" src="https://github.com/sineczek/HomeAssistant/blob/master/www/pir_cellar_leds.png">
</p>

```
[{"id":"d7de7d7b.163db","type":"mqtt in","z":"e9a8d4ce.d59338","name":"MQTT: PIR sensor","topic":"RFBridge/pir_schody","qos":"2","datatype":"auto","broker":"380c473f.e21928","x":130,"y":80,"wires":[["e3037077.06b01"]]},{"id":"e3037077.06b01","type":"switch","z":"e9a8d4ce.d59338","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"ON","vt":"str"},{"t":"eq","v":"OFF","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":310,"y":80,"wires":[["fa3b62.10afc4a"],["1181ae36.1a2d72"]]},{"id":"59708372.8f951c","type":"mqtt out","z":"e9a8d4ce.d59338","name":"MQTT: Cellar Stairs LEDs","topic":"cmnd/schody_fb/power","qos":"2","retain":"false","broker":"380c473f.e21928","x":690,"y":80,"wires":[],"inputLabels":["on"]},{"id":"1181ae36.1a2d72","type":"change","z":"e9a8d4ce.d59338","name":"OFF","rules":[{"t":"set","p":"payload","pt":"msg","to":"off","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":470,"y":120,"wires":[["59708372.8f951c"]]},{"id":"fa3b62.10afc4a","type":"change","z":"e9a8d4ce.d59338","name":"ON","rules":[{"t":"set","p":"payload","pt":"msg","to":"on","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":470,"y":40,"wires":[["59708372.8f951c","b38f9057.ff31b"]]},{"id":"b38f9057.ff31b","type":"change","z":"e9a8d4ce.d59338","name":"white","rules":[{"t":"set","p":"payload","pt":"msg","to":"255,255,255","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":630,"y":40,"wires":[["f8a4d92e.c42a68"]]},{"id":"f8a4d92e.c42a68","type":"mqtt out","z":"e9a8d4ce.d59338","name":"MQTT: Cellar Stairs LEDs (back to white)","topic":"cmnd/schody_fb/color","qos":"2","retain":"true","broker":"380c473f.e21928","x":900,"y":40,"wires":[]},{"id":"867b7c17.0599a","type":"comment","z":"e9a8d4ce.d59338","name":"PIR RF Cellar stairs","info":"","x":130,"y":40,"wires":[]},{"id":"380c473f.e21928","type":"mqtt-broker","name":"","broker":"192.168.4.9","port":"1883","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""}]
```

#### Kitchen sink leds
<p align="center">
  <img width="800" src="https://github.com/sineczek/HomeAssistant/blob/master/www/kitchen_sink_led.png">
</p>

```
[{"id":"e1e7f870.535098","type":"mqtt in","z":"e9a8d4ce.d59338","name":"MQTT: Shelly 2.5 Kitchen (2) and Bathroom (1)","topic":"shellies/shellyswitch25-kuchnia_i_lazienka/longpush/1","qos":"2","datatype":"auto","broker":"380c473f.e21928","x":220,"y":760,"wires":[["31564e02.1b8bd2"]]},{"id":"237e2a8c.e65a06","type":"change","z":"e9a8d4ce.d59338","name":"TOGGLE","rules":[{"t":"set","p":"payload","pt":"msg","to":"TOGGLE","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":660,"y":660,"wires":[["cc8a37ab.49ea58"]]},{"id":"31564e02.1b8bd2","type":"switch","z":"e9a8d4ce.d59338","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"str"},{"t":"eq","v":"0","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":520,"y":760,"wires":[["237e2a8c.e65a06"],["1b629c13.7a8064"]]},{"id":"1b629c13.7a8064","type":"api-call-service","z":"e9a8d4ce.d59338","name":"Shelly Relay 2","server":"5e7ed9c3.7c7708","version":1,"debugenabled":false,"service_domain":"light","service":"toggle","entityId":"light.shelly_shsw_25_40f52004e9b6_2","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":760,"y":780,"wires":[[]]},{"id":"cc8a37ab.49ea58","type":"mqtt out","z":"e9a8d4ce.d59338","name":"Kitchen sink LEDs","topic":"cmnd/LEDKuchnia_fb/power","qos":"2","retain":"false","broker":"380c473f.e21928","x":850,"y":660,"wires":[],"inputLabels":["on"]},{"id":"f2f8bc53.0f591","type":"comment","z":"e9a8d4ce.d59338","name":"Kitchen sink LEDs","info":"","x":130,"y":580,"wires":[]},{"id":"25940b35.69dfb4","type":"mqtt in","z":"e9a8d4ce.d59338","name":"RF Button","topic":"RFBridge/LEDKuchnia","qos":"2","datatype":"auto","broker":"380c473f.e21928","x":100,"y":660,"wires":[["237e2a8c.e65a06"]]},{"id":"52f7fd7d.84b014","type":"comment","z":"e9a8d4ce.d59338","name":"Kitchen sink LEDs RF Button","info":"","x":180,"y":620,"wires":[]},{"id":"d05ce857.3ee578","type":"comment","z":"e9a8d4ce.d59338","name":"Kitchen sink LEDs Relay","info":"","x":170,"y":720,"wires":[]},{"id":"47406fa1.8299c","type":"comment","z":"e9a8d4ce.d59338","name":"on shortpush toggle Shelly 2.5 Relay 2","info":"","x":830,"y":740,"wires":[]},{"id":"380c473f.e21928","type":"mqtt-broker","name":"","broker":"192.168.4.9","port":"1883","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"5e7ed9c3.7c7708","type":"server","name":"Home Assistant","legacy":false,"addon":true,"rejectUnauthorizedCerts":true,"ha_boolean":"y|yes|true|on|home|open","connectionDelay":true,"cacheJson":true}]
```

#### Living room manin lights
<p align="center">
  <img width="800" src="https://github.com/sineczek/HomeAssistant/blob/master/www/living_room_main_lights.png">
</p>

```
[{"id":"4b7f6dad.7313b4","type":"mqtt in","z":"e9a8d4ce.d59338","name":"MQTT: Shelly 2.5 Living Room (1 bulb)","topic":"shellies/shellyswitch25-swiatlo_dzienny/longpush/1","qos":"2","datatype":"auto","broker":"380c473f.e21928","x":190,"y":1000,"wires":[["14c6b53f.c2555b"]]},{"id":"14c6b53f.c2555b","type":"switch","z":"e9a8d4ce.d59338","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"str"},{"t":"eq","v":"1","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":510,"y":1000,"wires":[["d3cdec60.2cd28"],["28246c91.74cb54"]]},{"id":"28246c91.74cb54","type":"api-call-service","z":"e9a8d4ce.d59338","name":"Main light Shelly Relay 2","server":"5e7ed9c3.7c7708","version":1,"debugenabled":false,"service_domain":"light","service":"toggle","entityId":"light.shelly_shsw_25_10521c45e674_2","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":790,"y":1060,"wires":[[]]},{"id":"4d7886e3.e709d8","type":"comment","z":"e9a8d4ce.d59338","name":"on shortpush toggle Shelly 2.5 Relay 2","info":"","x":830,"y":920,"wires":[]},{"id":"da3a454.89e3cb8","type":"mqtt out","z":"e9a8d4ce.d59338","name":"Night lamp (WiFi Bulb)","topic":"lcs_lampkanocna/cmnd/POWER","qos":"","retain":"","broker":"380c473f.e21928","x":940,"y":960,"wires":[]},{"id":"d3cdec60.2cd28","type":"change","z":"e9a8d4ce.d59338","name":"TOGGLE","rules":[{"t":"set","p":"payload","pt":"msg","to":"TOGGLE","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":740,"y":960,"wires":[["da3a454.89e3cb8"]]},{"id":"4e630520.cbe11c","type":"comment","z":"e9a8d4ce.d59338","name":"on longpush toggle wifi bulb","info":"","x":800,"y":1020,"wires":[]},{"id":"cf70b88.5b83248","type":"comment","z":"e9a8d4ce.d59338","name":"Living Room Switch","info":"","x":130,"y":900,"wires":[]},{"id":"1ce223a7.184dcc","type":"comment","z":"e9a8d4ce.d59338","name":"One Bulb & Night lamp (WiFi Bulb)","info":"","x":200,"y":940,"wires":[]},{"id":"5ec593ae.978cdc","type":"comment","z":"e9a8d4ce.d59338","name":"Two Bulbs & Night lamp (Shelly Bulb)","info":"","x":210,"y":1200,"wires":[]},{"id":"14a9804f.d941e","type":"mqtt in","z":"e9a8d4ce.d59338","name":"MQTT: Shelly 2.5 Living Room (2 bulbs)","topic":"shellies/shellyswitch25-swiatlo_dzienny/longpush/0","qos":"2","datatype":"auto","broker":"380c473f.e21928","x":190,"y":1240,"wires":[["90c07aad.1873c8"]]},{"id":"90c07aad.1873c8","type":"switch","z":"e9a8d4ce.d59338","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"str"},{"t":"eq","v":"1","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":510,"y":1240,"wires":[["1d750e9d.f3ed81"],["ca2d249c.bf0ba8"]]},{"id":"ca2d249c.bf0ba8","type":"api-call-service","z":"e9a8d4ce.d59338","name":"Main light Shelly Relay 1","server":"5e7ed9c3.7c7708","version":1,"debugenabled":false,"service_domain":"light","service":"toggle","entityId":"light.shelly_shsw_25_10521c45e674_1","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":790,"y":1300,"wires":[[]]},{"id":"ff90cab.1906a38","type":"comment","z":"e9a8d4ce.d59338","name":"on shortpush toggle Shelly 2.5 Relay 1","info":"","x":830,"y":1160,"wires":[]},{"id":"9aa2751a.f7c248","type":"comment","z":"e9a8d4ce.d59338","name":"on longpush toggle shelly 1 Relay","info":"","x":810,"y":1260,"wires":[]},{"id":"1d750e9d.f3ed81","type":"api-call-service","z":"e9a8d4ce.d59338","name":"Night lamp Shelly Relay","server":"5e7ed9c3.7c7708","version":1,"debugenabled":false,"service_domain":"light","service":"toggle","entityId":"light.shelly_shsw_1_a4cf12f3e1e8","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":790,"y":1200,"wires":[[]]},{"id":"380c473f.e21928","type":"mqtt-broker","name":"","broker":"192.168.4.9","port":"1883","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"5e7ed9c3.7c7708","type":"server","name":"Home Assistant","legacy":false,"addon":true,"rejectUnauthorizedCerts":true,"ha_boolean":"y|yes|true|on|home|open","connectionDelay":true,"cacheJson":true}]
```

#### Living room night lamp button
<p align="center">
  <img width="800" src="https://github.com/sineczek/HomeAssistant/blob/master/www/living_room_night_lamp_button.png">
</p>

```
[{"id":"47c2ea6c.125754","type":"mqtt in","z":"e9a8d4ce.d59338","name":"MQTT: Shelly 1 ","topic":"shellies/shelly1-dziennalapkanocna/longpush/0","qos":"2","datatype":"auto","broker":"380c473f.e21928","x":120,"y":360,"wires":[["20a1130d.e54c0c"]]},{"id":"4ae78a01.23f374","type":"mqtt out","z":"e9a8d4ce.d59338","name":"Night lamp (WiFI Bulb)","topic":"lcs_lampkanocna/cmnd/POWER","qos":"","retain":"","broker":"380c473f.e21928","x":780,"y":340,"wires":[]},{"id":"f7bce3ef.dc4cf","type":"change","z":"e9a8d4ce.d59338","name":"TOGGLE","rules":[{"t":"set","p":"payload","pt":"msg","to":"TOGGLE","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":580,"y":340,"wires":[["4ae78a01.23f374"]]},{"id":"20a1130d.e54c0c","type":"switch","z":"e9a8d4ce.d59338","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"str"},{"t":"eq","v":"0","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":330,"y":360,"wires":[["f7bce3ef.dc4cf"],["71034aae.2e9cf4"]]},{"id":"71034aae.2e9cf4","type":"api-call-service","z":"e9a8d4ce.d59338","name":"Night lamp Shelly Relay","server":"5e7ed9c3.7c7708","version":1,"debugenabled":false,"service_domain":"light","service":"toggle","entityId":"light.shelly_shsw_1_a4cf12f3e1e8","data":"","dataType":"json","mergecontext":"","output_location":"","output_location_type":"none","mustacheAltTags":false,"x":630,"y":440,"wires":[[]]},{"id":"744d0aa5.9c5244","type":"comment","z":"e9a8d4ce.d59338","name":"short or long push","info":"\n    if longpush/0 = 0 toggle detached shelly1 relay (light.shelly-)\n        \n    if longpush/0 = 1 toggle wifi bulb (light.tasmota)","x":230,"y":320,"wires":[]},{"id":"9cba7ca4.4caa6","type":"comment","z":"e9a8d4ce.d59338","name":"on longpush toggle wifi bulb","info":"","x":640,"y":300,"wires":[]},{"id":"b04bf108.d5161","type":"comment","z":"e9a8d4ce.d59338","name":"on shortpush toggle shelly relay","info":"","x":650,"y":400,"wires":[]},{"id":"df9a9fe4.a7ef5","type":"comment","z":"e9a8d4ce.d59338","name":"Night lamp","info":"","x":100,"y":260,"wires":[]},{"id":"380c473f.e21928","type":"mqtt-broker","name":"","broker":"192.168.4.9","port":"1883","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"5e7ed9c3.7c7708","type":"server","name":"Home Assistant","legacy":false,"addon":true,"rejectUnauthorizedCerts":true,"ha_boolean":"y|yes|true|on|home|open","connectionDelay":true,"cacheJson":true}]
```